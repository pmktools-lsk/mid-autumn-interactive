<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>看故事學英語｜互動版</title>
<meta name="description" content="逐句跳播、雙語字幕、單字提示、小測驗。">
<style>
  :root{--bg:#0f172a;--panel:#111827;--muted:#9ca3af;--accent:#22d3ee;--accent2:#a78bfa;--danger:#ef4444;}
  html,body{height:100%;margin:0;background:#0b1220;color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif}
  .app{display:grid;grid-template-columns:1.15fr 1fr;gap:14px;max-width:1280px;margin:0 auto;padding:14px;height:100vh;box-sizing:border-box}
  @media (max-width: 900px){.app{grid-template-columns:1fr;grid-auto-rows:minmax(0,1fr)}}
  .left,.right{background:#111827;border-radius:14px;display:flex;flex-direction:column;min-height:0}
  .left header,.right header{padding:10px 14px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:10px}
  .left header h1,.right header h2{margin:0;font-size:16px;font-weight:600}
  .player{position:relative;display:flex;flex-direction:column;gap:8px;padding:14px;height:100%;box-sizing:border-box}

  /* ===== 影片容器 ===== */
  .vw{position:relative;width:100%;background:#000;border-radius:10px;overflow:hidden;}
  .vw video{display:block;width:100%;height:auto;max-height:65vh;object-fit:contain;}
  body.wide-left .vw video{max-height:78vh;}
  .vw.fill{height:65vh;}
  .vw.fill video{width:100%;height:100%;max-height:none;object-fit:cover;}
  .vw.zoom video{transform:scale(var(--zoom,1));transform-origin:center center;}

  .bar{height:4px;background:#111a36;border-radius:999px;overflow:hidden}
  .bar > span{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2))}
  .banner{display:none;margin:-4px 14px 8px;padding:10px 12px;border:1px solid rgba(239,68,68,.4);background:rgba(239,68,68,.12);color:#fecaca;border-radius:10px}

  .right main{display:grid;grid-template-rows:auto auto 1fr;gap:10px;padding:14px;overflow:hidden}
  .tools{display:flex;gap:8px}
  .now{background:#0b1022;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
  .now .en{font-size:20px;font-weight:700}
  .chip{background:#1f2541;border:1px solid rgba(255,255,255,.08);padding:6px 10px;border-radius:999px;font-size:12px;margin-right:6px}
  .hidden{display:none!important}

  .list{overflow:auto;border:1px solid rgba(255,255,255,.06);border-radius:12px}
  .row{display:grid;grid-template-columns:48px 74px 1fr;gap:10px;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.06);cursor:pointer}
  .row:hover{background:#12193a}
  .row.active{background:linear-gradient(90deg, rgba(34,211,238,.18), rgba(167,139,250,.12));}
  .idx{color:#9ca3af;text-align:right}
  .time{color:#9ca3af;font-variant-numeric:tabular-nums}
  .enline{font-weight:700;line-height:1.25}
  .zhline{opacity:.85}
  .compact .row{padding:6px 10px}
  .compact .enline{line-height:1.1}

  .controls{display:flex;flex-wrap:wrap;gap:8px}
  .btn{background:#1f2937;border:1px solid rgba(255,255,255,.1);padding:8px 10px;border-radius:10px;color:#e5e7eb;cursor:pointer}
  .btn:hover{border-color:rgba(255,255,255,.25)}
  .btn[aria-pressed="true"]{outline:2px solid var(--accent)}
  .speed{margin-left:auto;display:flex;align-items:center;gap:6px}

  /* YouTube 區塊 */
  .ytlink{margin-top:8px;text-align:center}
  .ytlink a{background:#ff0000;color:#fff;padding:8px 14px;border-radius:8px;text-decoration:none;font-weight:bold;display:inline-block}
  .ytlink a:hover{background:#cc0000}
</style>
</head>
<body>
  <div class="app">
    <section class="left">
      <header>
        <h1>故事影片</h1>
        <input type="file" id="fileVideo" accept="video/*" class="btn" />
        <span class="muted">未自動載入時請按「選擇檔案」→ 選取 (story.mov / story.mp4)。</span>
      </header>
      <div id="errorBanner" class="banner"></div>
      <div class="player">
        <div id="vw" class="vw">
          <video id="vid" controls crossorigin="anonymous"></video>
        </div>

        <div class="bar"><span id="prog"></span></div>

        <div class="controls">
          <button class="btn" id="prev">⏮ 上一句</button>
          <button class="btn" id="toggle">▶︎/⏸ 播放</button>
          <button class="btn" id="next">⏭ 下一句</button>
          <button class="btn" id="replay">🔁 重複本句</button>
          <button class="btn" id="autoPause" aria-pressed="false">🧩 逐句自動暫停</button>
          <button class="btn" id="wholeLoop" aria-pressed="false">🔂 整段循環</button>
          <button class="btn" id="abOnClick" aria-pressed="true">🅰️🅱️ 點句即循環</button>
          <button class="btn" id="clearLoop">⏹ 取消循環</button>
          <button class="btn" id="fillToggle">🖼️ 填滿畫面</button>
          <label class="speed hidden" id="zoomBox">變焦
            <input type="range" id="zoom" min="1" max="1.8" step="0.05" value="1" />
          </label>
          <label class="speed">速度
            <input type="range" min="0.5" max="1.25" step="0.05" value="1" id="rate" />
            <span id="rateVal">1.00×</span>
          </label>
        </div>

        <!-- YouTube 連結 -->
        <div class="ytlink">
          <p>到以下平台觀看：</p>
          <a href="https://youtube.com/shorts/rz78e3Zhf1s" target="_blank">YouTube</a>
        </div>
      </div>
    </section>

    <section class="right">
      <header>
        <h2>字幕對照 / 小測驗</h2>
        <div class="tools">
          <button class="btn" id="tabSub" aria-pressed="true">📜 字幕列表</button>
          <button class="btn" id="tabQuiz" aria-pressed="false">✍️ 小測驗</button>
          <button class="btn" id="toggleCompact" aria-pressed="false">緊湊模式</button>
        </div>
      </header>
      <main id="mainRight">
        <div id="now" class="now">
          <div class="en" id="nowEn">—</div>
          <div class="zh" id="nowZh">—</div>
          <div id="nowVocab"></div>
        </div>
        <div id="quizBox" class="hidden">
          <div id="quizQ"></div>
          <div id="quizChoices" style="margin:8px 0;"></div>
          <input id="quizInput" class="hidden" placeholder="Type your answer" />
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn" id="quizCheck">檢查</button>
            <button class="btn" id="quizNext">下一題</button>
            <span id="quizMsg" class="muted"></span>
          </div>
        </div>
        <div id="list" class="list"></div>
      </main>
    </section>
  </div>

<script>
/* 原本的 JS 保留不變 */
</script>
</body>
</html>





