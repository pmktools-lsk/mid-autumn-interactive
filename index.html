<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mid-Autumn Interactive</title>
  <style>
    body { display: flex; background:#0f1b2e; color:white; margin:0; font-family:Arial; }
    .video-container { flex: 2; padding:10px; }
    .controls { margin-top:10px; }
    video { width:100%; max-height:70vh; object-fit:contain; background:black; }
    .sidebar { flex: 1; padding:10px; overflow-y:auto; height:100vh; }
    .subtitle { padding:5px; border-bottom:1px solid #333; }
    .active { background:#223d66; }
    .quiz-box { margin-top:20px; padding:10px; border:1px solid #666; background:#1b2a3d; }
    .quiz-box input { padding:5px; }
    .quiz-box button { padding:5px; margin-left:5px; }
  </style>
</head>
<body>
  <div class="video-container">
    <h3>æ•…äº‹å½±ç‰‡</h3>
    <video id="video" controls>
      <source src="story.mov" type="video/mp4">
      Your browser does not support video.
    </video>
    <div class="controls">
      <button onclick="prevLine()">â® ä¸Šä¸€å¥</button>
      <button onclick="togglePlay()">â–¶ï¸ æ’­æ”¾ / æš«åœ</button>
      <button onclick="nextLine()">â­ ä¸‹ä¸€å¥</button>
      <button onclick="repeatLine()">ğŸ” é‡è¤‡æœ¬å¥</button>
      <button onclick="fitScreen()">ğŸ–¼ï¸ é©æ‡‰ç•«é¢</button>
    </div>
  </div>

  <div class="sidebar">
    <h3>å­—å¹•å°ç…§ / å°æ¸¬é©—</h3>
    <div id="subtitleList"></div>
    <div class="quiz-box">
      <p id="quizQuestion">Press "å‡ºé¡Œ" é–‹å§‹æ¸¬é©—</p>
      <input type="text" id="quizAnswer" placeholder="è¼¸å…¥ç­”æ¡ˆ">
      <button onclick="checkAnswer()">é€å‡º</button>
      <button onclick="newQuiz()">å‡ºé¡Œ</button>
      <p id="quizResult"></p>
    </div>
  </div>

<script>
const subtitles = [
  { start: 0, end: 4, en: "The Mid-Autumn Festival falls on the fifteenth day of the eighth month in the Chinese lunar calendar.", zh:"ä¸­ç§‹ç¯€åœ¨è¾²æ›†å…«æœˆåäº”é€™ä¸€å¤©ã€‚" },
  { start: 4, end: 9, en: "It is a time to admire the big, round moon.", zh:"é€™æ˜¯æŠ¬é ­è³åœ“æœˆçš„æ™‚åˆ»ã€‚" },
  { start: 9, end: 14, en: "This has been a special day in China for a very long time.", zh:"åœ¨ä¸­åœ‹ï¼Œé€™æ˜¯ä¸€å€‹æµå‚³å·²ä¹…çš„ç‰¹åˆ¥ç¯€æ—¥ã€‚" }
];

const video = document.getElementById("video");
const subtitleList = document.getElementById("subtitleList");

subtitles.forEach((s,i)=>{
  let div=document.createElement("div");
  div.className="subtitle";
  div.id="sub"+i;
  div.innerHTML=`<b>${formatTime(s.start)}</b> ${s.en}<br><span style="color:#ccc">${s.zh}</span>`;
  subtitleList.appendChild(div);
});

video.addEventListener("timeupdate",()=>{
  let t=video.currentTime;
  subtitles.forEach((s,i)=>{
    let line=document.getElementById("sub"+i);
    if(t>=s.start && t<s.end){
      line.classList.add("active");
      line.scrollIntoView({behavior:"smooth", block:"center"});
    }else{
      line.classList.remove("active");
    }
  });
});

// --- æ§åˆ¶ ---
function prevLine(){ seekTo(-1); }
function nextLine(){ seekTo(1); }
function seekTo(offset){
  let t=video.currentTime;
  let idx=subtitles.findIndex(s=>t>=s.start && t<s.end);
  if(idx>=0){
    let newIdx=Math.min(subtitles.length-1, Math.max(0, idx+offset));
    video.currentTime=subtitles[newIdx].start;
  }
}
function repeatLine(){
  let t=video.currentTime;
  let idx=subtitles.findIndex(s=>t>=s.start && t<s.end);
  if(idx>=0) video.currentTime=subtitles[idx].start;
}
function togglePlay(){ video.paused?video.play():video.pause(); }
function fitScreen(){ video.style.objectFit="contain"; }

// --- å°æ¸¬é©— (å¡«ç©º) ---
let currentQuiz=null;

function newQuiz(){
  let s=subtitles[Math.floor(Math.random()*subtitles.length)];
  let words=s.en.split(" ");
  let blankIdx=Math.floor(Math.random()*words.length);
  currentQuiz={answer:words[blankIdx].replace(/[^a-zA-Z]/g,"")};
  words[blankIdx]="_____";
  document.getElementById("quizQuestion").innerText=words.join(" ");
  document.getElementById("quizResult").innerText="";
  document.getElementById("quizAnswer").value="";
}

function checkAnswer(){
  let ans=document.getElementById("quizAnswer").value.trim();
  if(!currentQuiz) return;
  if(ans.toLowerCase()===currentQuiz.answer.toLowerCase()){
    document.getElementById("quizResult").innerText="âœ… æ­£ç¢º!";
  }else{
    document.getElementById("quizResult").innerText="âŒ éŒ¯èª¤, æ­£ç¢ºç­”æ¡ˆ: "+currentQuiz.answer;
  }
}

function formatTime(sec){
  let m=Math.floor(sec/60);
  let s=Math.floor(sec%60).toString().padStart(2,"0");
  return `${m}:${s}`;
}
</script>
</body>
</html>




