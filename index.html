<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>çœ‹æ•…äº‹å­¸è‹±èªï½œäº’å‹•ç‰ˆ</title>
<style>
  :root{
    --bg:#0b1627; --panel:#0f2238; --panel2:#132b47; --text:#eaf2ff;
    --muted:#a7bbd9; --accent:#3b82f6; --accent2:#16a34a; --danger:#ef4444;
    --btn:#344255; --btnH:#44566e;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family: system-ui, -apple-system, "Noto Sans TC", Segoe UI, Roboto, Arial, sans-serif;
    display:flex; gap:0
  }
  /* å·¦å³å…©æ¬„ï¼ˆåœ–äºŒçµæ§‹ï¼‰*/
  .left { flex: 1.25; padding:12px; display:flex; flex-direction:column; }
  .right{ flex: 0.95;  padding:12px; display:flex; flex-direction:column; background:var(--panel); }

  /* å½±ç‰‡å®¹å™¨ */
  .vw{
    border-radius:12px; overflow:hidden; background:#000; position:relative;
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
  }
  .vw video{ width:100%; height:auto; max-height:62vh; object-fit:contain; display:block; }
  .vw.fill{ height:62vh; }
  .vw.fill video{ width:100%; height:100%; max-height:none; object-fit:cover; }
  .vw.zoom video{ transform: scale(var(--zoom,1)); transform-origin:center; }

  /* æ§åˆ¶åˆ— */
  .controls{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; padding-top:10px; }
  .btn{
    background:var(--btn); border:none; color:#fff; padding:8px 12px; border-radius:8px;
    cursor:pointer; transition:.15s; display:inline-flex; align-items:center; gap:6px;
  }
  .btn:hover{ background:var(--btnH); }
  .btn[aria-pressed="true"]{ outline:2px solid var(--accent2); }
  .speed{ display:inline-flex; align-items:center; gap:8px; margin-left:4px;}
  .speed input[type="range"]{ width:180px }
  .hidden{ display:none !important; }

  /* å³å´ï¼šæ¨™é¡Œ+tabs */
  .title{ font-size:20px; font-weight:700; margin-bottom:12px; }
  .tabs{ display:flex; gap:8px; margin-bottom:10px; }
  .tab{ flex:0 0 auto; padding:8px 12px; border-radius:8px; cursor:pointer; background:var(--panel2); color:#fff; border:none;}
  .tab.active{ background:var(--accent); }
  .pane{ display:none; background:var(--panel2); border-radius:10px; padding:10px; overflow:auto; }
  .pane.active{ display:block; }

  /* å­—å¹•åˆ—è¡¨ï¼ˆè·Ÿéš¨æ»¾å‹•ï¼šåœ–äºŒé¢¨æ ¼ï¼‰*/
  .subs{ height:calc(100vh - 160px); overflow:auto; }
  .row{
    display:grid; grid-template-columns: 48px 80px 1fr; gap:10px; align-items:center;
    padding:10px; border-bottom:1px solid rgba(255,255,255,.06);
  }
  .row .idx{ text-align:center; color:var(--muted); }
  .row .ts{ background:#0c355f; color:#d7e7ff; padding:4px 8px; border-radius:6px; width:max-content; }
  .row .en{ font-size:16px; line-height:1.45; }
  .row .zh{ color:var(--muted); margin-top:3px; font-size:14px; }
  .row.active{ background:rgba(59,130,246,.18); }
  .row:hover{ background:rgba(255,255,255,.06); cursor:pointer; }

  /* å°æ¸¬é©—ï¼ˆä»ä¿ç•™åœ–äºŒåŸæœ‰æ¨£å¼ï¼‰*/
  .quiz-wrap{ height:calc(100vh - 160px); overflow:auto; }
  .quiz-item{ background:#0c2644; padding:12px; border-radius:8px; margin-bottom:10px; }
  .quiz-item input[type="text"]{ width:260px; padding:8px; border-radius:6px; border:1px solid #3d5777; background:#0b1f37; color:#fff; }
  .quiz-item .ok{ color:#22c55e; font-weight:700; margin-left:8px;}
  .quiz-item .ng{ color:#ef4444; font-weight:700; margin-left:8px;}

  /* YouTube æŒ‰éˆ•å€å¡Š */
  .ytRow{
    margin:12px 0 0; text-align:center;
  }
  .ytBtn{
    background:#ff0000; color:#fff; font-weight:700; border:none; border-radius:8px;
    display:inline-flex; align-items:center; gap:6px; padding:8px 12px; text-decoration:none;
  }
  .ytBtn:hover{ filter:brightness(.9); }
</style>
</head>
<body>

  <!-- å·¦å´ï¼šå½±ç‰‡ + æ§åˆ¶åˆ—ï¼ˆåœ–äºŒï¼‰ -->
  <section class="left">
    <div class="vw" id="vw">
      <video id="video" preload="metadata" controls>
        <source src="story.mov" type="video/mp4" />
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
      </video>
    </div>

    <div class="controls">
      <button class="btn" id="prev">â® ä¸Šä¸€å¥</button>
      <button class="btn" id="toggle">â–¶ï¸/â¸ æ’­æ”¾</button>
      <button class="btn" id="next">â­ ä¸‹ä¸€å¥</button>
      <button class="btn" id="replay">ğŸ” é‡è¤‡æœ¬å¥</button>

      <button class="btn" id="autoPause" aria-pressed="false">ğŸ§© é€å¥è‡ªå‹•æš«åœ</button>
      <button class="btn" id="wholeLoop" aria-pressed="false">ğŸ”‚ æ•´æ®µå¾ªç’°</button>
      <button class="btn" id="abOnClick" aria-pressed="true">ğŸ…°ï¸ğŸ…±ï¸ é»å¥å³å¾ªç’°</button>
      <button class="btn" id="clearLoop">â¹ å–æ¶ˆå¾ªç’°</button>

      <button class="btn" id="fillToggle">ğŸ–¼ï¸ å¡«æ»¿ç•«é¢</button>
      <label class="speed hidden" id="zoomBox">è®Šç„¦
        <input type="range" id="zoom" min="1" max="1.8" step="0.05" value="1">
      </label>

      <label class="speed">é€Ÿåº¦
        <input type="range" min="0.5" max="1.25" step="0.05" value="1" id="rate">
        <span id="rateVal">1.00Ã—</span>
      </label>
    </div>

    <!-- âœ… YouTube é€£çµï¼ˆæ–°å¢ï¼Œä¿æŒåœ–äºŒç‰ˆå‹ä¸è®Šï¼‰ -->
    <div class="ytRow">
      <span style="margin-right:8px;color:#d1e3ff">åˆ°ä»¥ä¸‹å¹³å°è§€çœ‹ï¼š</span>
      <a class="ytBtn" href="https://youtube.com/shorts/rz78e3Zhf1s" target="_blank" rel="noopener">
        â–¶ YouTube
      </a>
    </div>
  </section>

  <!-- å³å´ï¼šå­—å¹•åˆ—è¡¨ / å°æ¸¬é©— / ç·Šæ¹Šæ¨¡å¼ï¼ˆåœ–äºŒï¼‰ -->
  <section class="right">
    <div class="title">å­—å¹•å°ç…§ / å°æ¸¬é©—</div>
    <div class="tabs">
      <button class="tab active" data-pane="pane-subs">å­—å¹•åˆ—è¡¨</button>
      <button class="tab" data-pane="pane-quiz">å°æ¸¬é©—</button>
      <button class="tab" data-pane="pane-compact">ç·Šæ¹Šæ¨¡å¼</button>
    </div>

    <!-- å­—å¹•åˆ—è¡¨ -->
    <div class="pane active" id="pane-subs">
      <div class="subs" id="subs"></div>
    </div>

    <!-- å°æ¸¬é©—ï¼ˆè‹±æ–‡å¡«ç©ºï¼‰ -->
    <div class="pane" id="pane-quiz">
      <div class="quiz-wrap" id="quizWrap"></div>
    </div>

    <!-- ç·Šæ¹Šæ¨¡å¼ï¼ˆç¤ºä¾‹ï¼šåªé¡¯ç¤ºè‹±æ–‡ï¼‰ -->
    <div class="pane" id="pane-compact">
      <div class="subs" id="subsCompact"></div>
    </div>
  </section>

<script>
/* ====== Demo å­—å¹•è³‡æ–™ï¼ˆåœ–äºŒåŒä¸€æ‰¹ï¼‰====== */
const cues = [
  {t0:  0.00, t1:  4.00, en:"The Mid-Autumn Festival falls on the fifteenth day of the eighth month in the Chinese lunar calendar.", zh:"ä¸­ç§‹ç¯€åœ¨è¾²æ›†å…«æœˆåäº”é€™ä¸€å¤©ã€‚"},
  {t0:  4.00, t1:  9.00, en:"It is a time to admire the big, round moon.", zh:"é€™æ˜¯æŠ¬é ­è³åœ“æœˆçš„æ™‚åˆ»ã€‚"},
  {t0:  9.00, t1: 14.00, en:"This has been a special day in China for a very long time.", zh:"åœ¨ä¸­åœ‹ï¼Œé€™æ˜¯ä¸€å€‹æµå‚³å·²ä¹…çš„ç‰¹åˆ¥ç¯€æ—¥ã€‚"},
  {t0: 14.00, t1: 19.00, en:"Long ago, there were ten suns in the sky.", zh:"å¾ˆä¹…ä»¥å‰ï¼Œå¤©ç©ºä¸­æ›¾ç¶“åŒæ™‚å‡ºç¾åå€‹å¤ªé™½ã€‚"},
  {t0: 19.00, t1: 24.00, en:"It was unbearably hot, and people suffered.", zh:"å¤©æ°£ç‚ç†±é›£è€ï¼Œäººå€‘å‚™å—ç…ç†¬ã€‚"},
  {t0: 24.00, t1: 28.00, en:"A brave archer named Hou Yi helped them.", zh:"ä¸€ä½å‹‡æ•¢çš„ç¥å°„æ‰‹åç¾¿å‡ºæ‰‹ç›¸æ•‘ã€‚"},
  {t0: 28.00, t1: 34.00, en:"He climbed a tall mountain and shot down nine suns with his strong bow.", zh:"ä»–ç™»ä¸Šé«˜å±±ï¼Œæ‹‰é–‹å¼·å¼“ï¼Œå°„ä¸‹äº†ä¹å€‹å¤ªé™½ã€‚"}
];

const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));

const video = $('#video');
const subsEl = $('#subs');
const subsCompactEl = $('#subsCompact');
const quizWrap = $('#quizWrap');

/* ====== å»ºç«‹å­—å¹•åˆ—è¡¨ï¼ˆåœ–äºŒæ¨£å¼ï¼‰ ====== */
function timefmt(s){ const m=Math.floor(s/60), ss=String(Math.floor(s%60)).padStart(2,'0'); return `${m}:${ss}`;}
function renderSubs(){
  subsEl.innerHTML = cues.map((c,i)=>`
    <div class="row" data-i="${i}">
      <div class="idx">${i+1}</div>
      <div class="ts">${timefmt(c.t0)}</div>
      <div>
        <div class="en">${c.en}</div>
        <div class="zh">${c.zh}</div>
      </div>
    </div>`).join('');
  subsCompactEl.innerHTML = cues.map((c,i)=>`
    <div class="row" data-i="${i}">
      <div class="idx">${i+1}</div>
      <div class="ts">${timefmt(c.t0)}</div>
      <div><div class="en">${c.en}</div></div>
    </div>`).join('');

  // é»å¥è·³æ’­
  subsEl.querySelectorAll('.row, .row *').forEach(el=>{
    el.addEventListener('click',e=>{
      const row = e.currentTarget.closest('.row'); if(!row) return;
      const i = +row.dataset.i; video.currentTime = cues[i].t0; video.play();
    }, true);
  });
  subsCompactEl.querySelectorAll('.row').forEach(row=>{
    row.addEventListener('click', ()=>{ const i=+row.dataset.i; video.currentTime=cues[i].t0; video.play(); });
  });
}

/* ====== å½±ç‰‡æ’­æ”¾æ™‚é«˜äº® + æ»¾å‹• ====== */
video.addEventListener('timeupdate', ()=>{
  const t = video.currentTime;
  let idx = cues.findIndex(c=> t>=c.t0 && t<c.t1 );
  if(idx<0) idx=cues.length-1; // çµå°¾

  $$('#subs .row').forEach((r,i)=>{
    r.classList.toggle('active', i===idx);
    if(i===idx) r.scrollIntoView({block:'center'});
  });
  $$('#subsCompact .row').forEach((r,i)=>{
    r.classList.toggle('active', i===idx);
    if(i===idx) r.scrollIntoView({block:'center'});
  });
});

/* ====== å°æ¸¬é©—ï¼šè‹±æ–‡å¡«ç©ºï¼ˆå¾å­—å¹•æŠ½å­—ï¼‰ ====== */
function pickBlank(text){
  // å–è¼ƒé•·çš„å–®å­—ä¾†æŒ–ç©º
  const words = text.split(/\b/).filter(w=>/^[A-Za-z]+$/.test(w));
  const cand = words.filter(w=>w.length>=4);
  const target = (cand.length? cand : words)[ Math.floor(Math.random()* (cand.length? cand.length:words.length)) ];
  const answer = target;
  const masked = text.replace(new RegExp('\\b'+answer+'\\b'), '_____');
  return {masked, answer};
}
function renderQuiz(){
  quizWrap.innerHTML = cues.map((c,i)=>{
    const {masked, answer} = pickBlank(c.en);
    return `
      <div class="quiz-item" data-ans="${answer.toLowerCase()}">
        <div style="margin-bottom:6px;"><b>ç¬¬ ${i+1} é¡Œ</b></div>
        <div style="margin-bottom:6px">${masked}</div>
        <input type="text" placeholder="è¼¸å…¥ç¼ºçš„å–®å­—">
        <button class="btn btn-sm">é€å‡º</button>
        <span class="result"></span>
      </div>`;
  }).join('');

  quizWrap.querySelectorAll('.quiz-item .btn').forEach(btn=>{
    btn.addEventListener('click', e=>{
      const box = e.currentTarget.closest('.quiz-item');
      const ans = box.dataset.ans;
      const val = box.querySelector('input').value.trim().toLowerCase();
      const res = box.querySelector('.result');
      if(val===ans){ res.textContent='âœ… æ­£ç¢º'; res.className='result ok'; }
      else{ res.textContent='âŒ æ­£ç¢ºï¼š'+ans; res.className='result ng'; }
    });
  });
}

/* ====== ä¸Šä¸€å¥/ä¸‹ä¸€å¥/é‡è¤‡æœ¬å¥/é€Ÿåº¦ ====== */
$('#prev').onclick = ()=>{ jump(-1); };
$('#next').onclick = ()=>{ jump(1); };
$('#replay').onclick= ()=>{ const t=video.currentTime; const i=cues.findIndex(c=>t>=c.t0&&t<c.t1); if(i>=0) video.currentTime=cues[i].t0; video.play(); };
$('#toggle').onclick= ()=> video.paused?video.play():video.pause();

function jump(dir){
  const t=video.currentTime;
  let i=cues.findIndex(c=>t>=c.t0&&t<c.t1);
  if(i<0) i=0;
  i=Math.min(cues.length-1, Math.max(0, i+dir));
  video.currentTime=cues[i].t0; video.play();
}
const rate = $('#rate'), rateVal = $('#rateVal');
rate.oninput = ()=>{ video.playbackRate = +rate.value; rateVal.textContent = (+rate.value).toFixed(2)+'Ã—'; };

/* ====== å¡«æ»¿/è®Šç„¦ï¼ˆä¿æŒåœ–äºŒé¢¨æ ¼ï¼‰ ====== */
const vw = $('#vw'), fillBtn=$('#fillToggle'), zoomBox=$('#zoomBox'), zoom=$('#zoom');
fillBtn.onclick = ()=>{
  vw.classList.toggle('fill');
  const on = vw.classList.contains('fill');
  fillBtn.textContent = on ? 'â†©ï¸ é©æ‡‰ç•«é¢' : 'ğŸ–¼ï¸ å¡«æ»¿ç•«é¢';
  zoomBox.classList.toggle('hidden', !on);
  vw.classList.toggle('zoom', on);
  if(!on){ vw.style.removeProperty('--zoom'); zoom.value=1; }
};
zoom.oninput = ()=> vw.style.setProperty('--zoom', zoom.value);

/* ====== Tabs ====== */
$$('.tab').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    $$('.tab').forEach(b=>b.classList.remove('active'));
    $$('.pane').forEach(p=>p.classList.remove('active'));
    btn.classList.add('active');
    $('#'+btn.dataset.pane).classList.add('active');
  });
});

/* ====== åˆå§‹åŒ– ====== */
renderSubs();
renderQuiz();
</script>
</body>
</html>





